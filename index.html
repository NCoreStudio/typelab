<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SHINDAN LAB｜あなたを深掘りする診断の実験室</title>
<meta name="description" content="恋愛・友達・仕事・その他ジャンル別の診断ツールを集めたポータルサイト。自己分析から関係改善まで、遊び心あふれる診断で自分を発見しよう。">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kaisei+Decol:wght@400;700&family=Zen+Kaku+Gothic+New:wght@300;400;700;900&family=DotGothic16&family=M+PLUS+Rounded+1c:wght@300;400;700&display=swap" rel="stylesheet">

<style>
/* ═══════════════════════════════════════════════
   SHINDAN LAB — メインスタイル
   テーマ：実験室 × 手帳ステッカー × 遊びごころ
   ═══════════════════════════════════════════════ */

:root {
  /* ─── カラーパレット ─── */
  --ink:         #1a1424;
  --ink-mid:     #5c4f6e;
  --ink-soft:    #9b8fb0;
  --bg:          #faf8ff;
  --bg-warm:     #f7f4f0;
  --paper:       #ffffff;

  /* ジャンルカラー */
  --love:        #ff6b9d;
  --love-light:  #ffe4ef;
  --love-dark:   #d63880;
  --friend:      #43c59e;
  --friend-light:#d9f5ec;
  --friend-dark: #2a9a7a;
  --work:        #5b8dee;
  --work-light:  #dde9ff;
  --work-dark:   #3a6bcc;
  --other:       #f5a623;
  --other-light: #fef0d5;
  --other-dark:  #c87e10;

  /* アクセント */
  --accent:      #7c3aed;
  --accent-light:#ede9fe;
  --new-badge:   #ff4757;

  /* シャドウ */
  --shadow-sm:   0 2px 8px rgba(90,60,120,.10);
  --shadow-md:   0 4px 24px rgba(90,60,120,.14);
  --shadow-lg:   0 8px 40px rgba(90,60,120,.18);
  --shadow-card: 0 2px 12px rgba(90,60,120,.08), 0 0 0 1px rgba(124,58,237,.06);

  /* タイポグラフィ */
  --font-display: 'Kaisei Decol', serif;
  --font-body:    'Zen Kaku Gothic New', sans-serif;
  --font-dot:     'DotGothic16', sans-serif;
  --font-round:   'M PLUS Rounded 1c', sans-serif;

  /* その他 */
  --r-sm:  8px;
  --r-md:  16px;
  --r-lg:  24px;
  --r-xl:  36px;
  --r-full:9999px;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }

body {
  font-family: var(--font-body);
  background: var(--bg);
  color: var(--ink);
  overflow-x: hidden;
  min-height: 100vh;
}

/* ── ノイズテクスチャオーバーレイ ── */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 0;
  opacity: 0.5;
}

/* ── マイページアイコン ── */
.mypage-icon-btn {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 8px 12px;
  background: var(--bg);
  border: 2px solid var(--border);
  border-radius: var(--r-full);
  color: var(--ink);
  text-decoration: none;
  font-weight: 700;
  font-size: 0.85rem;
  transition: all .2s;
  position: relative;
  flex-shrink: 0;
  z-index: 1001;
}
.mypage-icon-btn:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.mypage-avatar-ring {
  width: 34px; height: 34px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent), #c026d3);
  display: grid;
  place-items: center;
  font-size: 1.05rem;
  flex-shrink: 0;
  transition: transform .2s;
}
.mypage-icon-btn:hover .mypage-avatar-ring { transform: rotate(-8deg) scale(1.08); }
.mypage-label {
  font-size: 0.78rem;
  font-weight: 700;
  letter-spacing: 0.03em;
  white-space: nowrap;
}
/* ログイン済み緑ドット */
.mypage-login-dot {
  position: absolute;
  top: 2px; right: 2px;
  width: 9px; height: 9px;
  border-radius: 50%;
  background: #22c55e;
  border: 2px solid white;
  display: none;
}
.mypage-login-dot.visible { display: block; }

/* ════════════════════════════════════════
   NAVIGATION
   ════════════════════════════════════════ */

.site-header {
  position: sticky;
  top: 0;
  z-index: 1000;
  background: rgba(250,248,255,0.88);
  backdrop-filter: blur(16px) saturate(180%);
  -webkit-backdrop-filter: blur(16px) saturate(180%);
  border-bottom: 1.5px solid rgba(124,58,237,.10);
  padding: 0 clamp(16px, 4vw, 48px);
}

.header-inner {
  max-width: 1200px;
  margin: 0 auto;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.site-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  flex-shrink: 0;
}

.logo-mark {
  width: 36px;
  height: 36px;
  background: linear-gradient(135deg, var(--accent) 0%, #c026d3 100%);
  border-radius: 10px;
  display: grid;
  place-items: center;
  font-family: var(--font-dot);
  color: white;
  font-size: 14px;
  letter-spacing: -0.5px;
  flex-shrink: 0;
  position: relative;
  overflow: hidden;
}

.logo-mark::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,.2) 0%, transparent 60%);
}

.logo-text {
  font-family: var(--font-display);
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--ink);
  letter-spacing: 0.02em;
}

.logo-sub {
  font-family: var(--font-dot);
  font-size: 0.6rem;
  color: var(--ink-soft);
  letter-spacing: 0.1em;
  display: block;
  line-height: 1;
  margin-top: 2px;
}

/* ナビメニュー */
/* ══════════════════════════════════════
   デスクトップナビ（headerの外に配置）
   ══════════════════════════════════════ */
.site-nav {
  /* デスクトップ：headerに重ねてfixedで表示
     右側にmypageボタン(約120px)+ハンバーガー(44px)+gap分の余白を確保 */
  position: fixed;
  top: 0;
  /* マイページボタン幅(~120px) + ハンバーガー(44px) + 余白 = 約200px */
  right: calc(clamp(16px, 4vw, 48px) + 200px);
  height: 64px;         /* header-innerと同じ高さ */
  display: flex;
  align-items: center;
  gap: 4px;
  list-style: none;
  z-index: 1001;        /* headerより上 */
  pointer-events: auto;
}

.site-nav a {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  border-radius: var(--r-full);
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--ink-mid);
  text-decoration: none;
  letter-spacing: 0.03em;
  transition: background .2s, color .2s, transform .15s;
  white-space: nowrap;
}

.site-nav a:hover {
  background: var(--accent-light);
  color: var(--accent);
  transform: translateY(-1px);
}

.nav-icon { font-size: 0.9rem; }

.nav-premium a {
  background: linear-gradient(135deg, var(--accent), #c026d3);
  color: white !important;
  box-shadow: 0 2px 8px rgba(124,58,237,.3);
}

.nav-premium a:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 14px rgba(124,58,237,.4);
  background: linear-gradient(135deg, var(--accent), #c026d3) !important;
  color: white !important;
}

/* ハンバーガー（スマホ） */
.hamburger {
  display: none;
  flex-direction: column;
  gap: 5px;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  background: var(--bg);
  border: none;
  cursor: pointer;
  z-index: 1001;
  position: relative;
}

.hamburger span {
  width: 24px;
  height: 2px;
  background: var(--ink);
  border-radius: 2px;
  transition: all .3s;
}

/* ════════════════════════════════════════
   HERO SECTION
   ════════════════════════════════════════ */

.hero {
  position: relative;
  padding: clamp(60px, 10vw, 120px) clamp(16px, 4vw, 48px) clamp(48px, 8vw, 80px);
  overflow: hidden;
  min-height: 560px;
  display: flex;
  align-items: center;
}

/* ── 背景グラデーションオーブ ── */
.hero-orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(80px);
  opacity: 0.5;
  pointer-events: none;
  animation: floatOrb 8s ease-in-out infinite;
}

.hero-orb-1 {
  width: 600px; height: 600px;
  background: radial-gradient(circle, rgba(255,107,157,.25) 0%, transparent 70%);
  top: -200px; right: -100px;
  animation-delay: 0s;
}

.hero-orb-2 {
  width: 500px; height: 500px;
  background: radial-gradient(circle, rgba(124,58,237,.18) 0%, transparent 70%);
  bottom: -150px; left: -80px;
  animation-delay: -3s;
}

.hero-orb-3 {
  width: 350px; height: 350px;
  background: radial-gradient(circle, rgba(67,197,158,.2) 0%, transparent 70%);
  top: 30%; left: 35%;
  animation-delay: -5s;
}

@keyframes floatOrb {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(20px, -30px) scale(1.05); }
  66% { transform: translate(-15px, 15px) scale(0.97); }
}

.hero-inner {
  position: relative;
  z-index: 1;
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
}

.hero-eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 5px 14px;
  background: var(--accent-light);
  border: 1.5px solid rgba(124,58,237,.2);
  border-radius: var(--r-full);
  font-family: var(--font-dot);
  font-size: 0.72rem;
  color: var(--accent);
  letter-spacing: 0.12em;
  margin-bottom: 24px;
  animation: fadeSlideUp 0.6s ease both;
}

.hero-eyebrow::before { content: '⚗️'; }

.hero-heading {
  font-family: var(--font-display);
  font-size: clamp(2.4rem, 6vw, 5.2rem);
  font-weight: 700;
  line-height: 1.15;
  margin-bottom: 20px;
  animation: fadeSlideUp 0.6s ease 0.1s both;
}

.hero-heading .line-em {
  display: block;
  background: linear-gradient(90deg, var(--love), var(--accent), #06b6d4);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero-desc {
  font-size: clamp(0.9rem, 1.8vw, 1.05rem);
  line-height: 1.9;
  color: var(--ink-mid);
  max-width: 560px;
  margin-bottom: 36px;
  font-weight: 400;
  animation: fadeSlideUp 0.6s ease 0.2s both;
}

.hero-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  animation: fadeSlideUp 0.6s ease 0.3s both;
}

.btn-primary {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 14px 28px;
  background: linear-gradient(135deg, var(--accent) 0%, #c026d3 100%);
  color: white;
  border-radius: var(--r-full);
  font-family: var(--font-body);
  font-size: 0.92rem;
  font-weight: 700;
  text-decoration: none;
  letter-spacing: 0.04em;
  box-shadow: 0 4px 16px rgba(124,58,237,.3);
  transition: transform .2s, box-shadow .2s;
}

.btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 24px rgba(124,58,237,.4);
}

.btn-ghost {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 13px 24px;
  background: transparent;
  color: var(--ink-mid);
  border: 1.5px solid rgba(90,60,120,.2);
  border-radius: var(--r-full);
  font-family: var(--font-body);
  font-size: 0.92rem;
  font-weight: 700;
  text-decoration: none;
  transition: background .2s, border-color .2s, transform .2s;
}

.btn-ghost:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  color: var(--accent);
  transform: translateY(-2px);
}

/* ── ヒーロー 浮かぶカードデコ ── */
.hero-deco {
  position: absolute;
  right: clamp(20px, 6vw, 100px);
  top: 50%;
  transform: translateY(-50%);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  animation: fadeSlideUp 0.8s ease 0.4s both;
}

.deco-chip {
  background: white;
  border-radius: var(--r-lg);
  padding: 16px 18px;
  box-shadow: var(--shadow-md);
  border: 1.5px solid rgba(124,58,237,.08);
  text-align: center;
  min-width: 110px;
  transition: transform .3s ease;
}

.deco-chip:nth-child(odd) { transform: translateY(8px); }
.deco-chip:nth-child(even) { transform: translateY(-8px); }
.deco-chip:hover { transform: translateY(-4px) scale(1.04) !important; }

.deco-chip .emoji { font-size: 1.8rem; display: block; margin-bottom: 6px; }
.deco-chip .label { font-size: 0.72rem; color: var(--ink-mid); font-weight: 700; letter-spacing: 0.05em; }

/* ── 統計バー ── */
.hero-stats {
  display: flex;
  gap: 32px;
  margin-top: 44px;
  animation: fadeSlideUp 0.6s ease 0.45s both;
}

.stat-item { text-align: left; }

.stat-num {
  font-family: var(--font-display);
  font-size: 2rem;
  font-weight: 700;
  color: var(--ink);
  line-height: 1;
  display: block;
}

.stat-label {
  font-size: 0.72rem;
  color: var(--ink-soft);
  font-weight: 700;
  letter-spacing: 0.08em;
  margin-top: 4px;
  display: block;
}

/* ════════════════════════════════════════
   新着 SECTION
   ════════════════════════════════════════ */

.section-new {
  padding: clamp(48px, 6vw, 80px) clamp(16px, 4vw, 48px);
  position: relative;
  z-index: 1;
}

.section-inner { max-width: 1200px; margin: 0 auto; }

.section-header {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  margin-bottom: 28px;
  gap: 12px;
}

.section-title-group {}

.section-eyebrow {
  font-family: var(--font-dot);
  font-size: 0.72rem;
  letter-spacing: 0.14em;
  color: var(--ink-soft);
  text-transform: uppercase;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.section-eyebrow::before {
  content: '';
  display: inline-block;
  width: 20px;
  height: 1.5px;
  background: currentColor;
}

.section-title {
  font-family: var(--font-display);
  font-size: clamp(1.4rem, 3vw, 2rem);
  font-weight: 700;
  color: var(--ink);
}

.see-all {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 18px;
  border-radius: var(--r-full);
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--accent);
  text-decoration: none;
  border: 1.5px solid rgba(124,58,237,.25);
  transition: background .2s, transform .2s;
  white-space: nowrap;
  flex-shrink: 0;
}

.see-all:hover { background: var(--accent-light); transform: translateX(3px); }

/* 新着スクロールトレイ */
.new-scroll-tray {
  display: flex;
  gap: 20px;
  overflow-x: auto;
  padding-bottom: 12px;
  scroll-snap-type: x mandatory;
  scrollbar-width: none;
}

.new-scroll-tray::-webkit-scrollbar { display: none; }

/* ── 新着カード ── */
.new-card {
  scroll-snap-align: start;
  flex: 0 0 clamp(240px, 32vw, 320px);
  background: white;
  border-radius: var(--r-xl);
  overflow: hidden;
  box-shadow: var(--shadow-card);
  text-decoration: none;
  color: inherit;
  position: relative;
  transition: transform .3s ease, box-shadow .3s ease;
  border: 1.5px solid rgba(124,58,237,.06);
}

.new-card:hover {
  transform: translateY(-6px);
  box-shadow: var(--shadow-lg);
}

.new-card-thumb {
  height: 140px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3.5rem;
  position: relative;
  overflow: hidden;
}

.new-card-thumb::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0; right: 0;
  height: 40px;
  background: linear-gradient(to bottom, transparent, white);
}

.new-card-body { padding: 16px 20px 20px; }

.new-card-badge {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 3px 10px;
  border-radius: var(--r-full);
  font-size: 0.68rem;
  font-weight: 700;
  letter-spacing: 0.06em;
  margin-bottom: 10px;
}

.new-card-title {
  font-family: var(--font-display);
  font-size: 1rem;
  font-weight: 700;
  line-height: 1.5;
  margin-bottom: 8px;
  color: var(--ink);
}

.new-card-desc {
  font-size: 0.78rem;
  color: var(--ink-soft);
  line-height: 1.7;
}

.new-tag {
  position: absolute;
  top: 12px;
  right: 12px;
  background: var(--new-badge);
  color: white;
  font-family: var(--font-dot);
  font-size: 0.66rem;
  padding: 3px 8px;
  border-radius: var(--r-full);
  letter-spacing: 0.08em;
  animation: badgePulse 2s ease-in-out infinite;
}

@keyframes badgePulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(255,71,87,.5); }
  50% { box-shadow: 0 0 0 6px rgba(255,71,87,0); }
}

/* ════════════════════════════════════════
   ジャンル TABS
   ════════════════════════════════════════ */

.section-genres {
  padding: clamp(24px, 4vw, 48px) clamp(16px, 4vw, 48px) clamp(48px, 6vw, 80px);
  position: relative;
  z-index: 1;
}

.genre-tabs {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 36px;
}

.genre-tab {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  border-radius: var(--r-full);
  font-size: 0.88rem;
  font-weight: 700;
  cursor: pointer;
  border: 2px solid transparent;
  background: white;
  color: var(--ink-mid);
  transition: all .22s ease;
  box-shadow: var(--shadow-sm);
  letter-spacing: 0.02em;
}

.genre-tab:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }

.genre-tab[data-genre="all"].active,
.genre-tab[data-genre="all"]:hover {
  background: var(--ink);
  color: white;
  border-color: var(--ink);
}

.genre-tab[data-genre="love"].active {
  background: var(--love-light);
  color: var(--love-dark);
  border-color: var(--love);
}

.genre-tab[data-genre="friend"].active {
  background: var(--friend-light);
  color: var(--friend-dark);
  border-color: var(--friend);
}

.genre-tab[data-genre="work"].active {
  background: var(--work-light);
  color: var(--work-dark);
  border-color: var(--work);
}

.genre-tab[data-genre="other"].active {
  background: var(--other-light);
  color: var(--other-dark);
  border-color: var(--other);
}

/* ── ジャンル内 見出し ── */
.genre-section { margin-bottom: 56px; }

.genre-section[data-genre="love"] { --gc: var(--love); --gc-light: var(--love-light); --gc-dark: var(--love-dark); }
.genre-section[data-genre="friend"] { --gc: var(--friend); --gc-light: var(--friend-light); --gc-dark: var(--friend-dark); }
.genre-section[data-genre="work"] { --gc: var(--work); --gc-light: var(--work-light); --gc-dark: var(--work-dark); }
.genre-section[data-genre="other"] { --gc: var(--other); --gc-light: var(--other-light); --gc-dark: var(--other-dark); }

.genre-heading {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

.genre-heading-pill {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 20px;
  background: var(--gc-light);
  color: var(--gc-dark);
  border-radius: var(--r-full);
  font-family: var(--font-display);
  font-size: 1.1rem;
  font-weight: 700;
  border: 2px solid var(--gc);
}

.genre-count {
  font-family: var(--font-dot);
  font-size: 0.72rem;
  color: var(--ink-soft);
  letter-spacing: 0.1em;
}

/* ── 診断カードグリッド ── */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(clamp(200px, 22vw, 260px), 1fr));
  gap: 16px;
}

/* ── 診断カード ── */
.diag-card {
  background: white;
  border-radius: var(--r-lg);
  padding: 20px;
  box-shadow: var(--shadow-sm);
  border: 1.5px solid rgba(0,0,0,.05);
  text-decoration: none;
  color: inherit;
  display: flex;
  flex-direction: column;
  gap: 10px;
  transition: transform .25s ease, box-shadow .25s ease;
  position: relative;
  overflow: hidden;
}

.diag-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
  background: var(--gc, #e2e8f0);
  border-radius: 3px 3px 0 0;
}

.diag-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-md);
}

.diag-card.active:hover { border-color: rgba(var(--gc-rgb), .3); }

/* 実装予定カード */
.diag-card.coming-soon {
  opacity: 0.55;
  pointer-events: none;
}

.diag-card.coming-soon::after {
  content: '実装予定';
  position: absolute;
  top: 12px; right: 12px;
  background: var(--bg-warm);
  border: 1.5px dashed #ccc;
  color: #bbb;
  font-family: var(--font-dot);
  font-size: 0.62rem;
  padding: 2px 8px;
  border-radius: var(--r-full);
  letter-spacing: 0.1em;
}

.card-icon {
  width: 44px; height: 44px;
  border-radius: var(--r-sm);
  background: var(--gc-light, var(--bg-warm));
  display: grid;
  place-items: center;
  font-size: 1.5rem;
  flex-shrink: 0;
}

.card-genre-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  background: var(--gc-light, var(--bg-warm));
  color: var(--gc-dark, var(--ink-soft));
  border-radius: var(--r-full);
  font-size: 0.66rem;
  font-weight: 700;
  letter-spacing: 0.05em;
  width: fit-content;
}

.card-title {
  font-family: var(--font-display);
  font-size: 0.95rem;
  font-weight: 700;
  line-height: 1.5;
  color: var(--ink);
}

.card-desc {
  font-size: 0.76rem;
  color: var(--ink-soft);
  line-height: 1.7;
  flex: 1;
}

.card-meta {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 4px;
}

.card-questions {
  font-family: var(--font-dot);
  font-size: 0.66rem;
  color: var(--ink-soft);
  letter-spacing: 0.06em;
}

.card-arrow {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: var(--gc-light, var(--bg-warm));
  color: var(--gc-dark, var(--ink-mid));
  display: grid;
  place-items: center;
  font-size: 0.9rem;
  transition: background .2s, transform .2s;
}

.diag-card:hover .card-arrow {
  background: var(--gc, var(--accent));
  color: white;
  transform: translateX(3px);
}

/* ════════════════════════════════════════
   フッター
   ════════════════════════════════════════ */

.site-footer {
  background: var(--ink);
  color: rgba(255,255,255,.7);
  padding: clamp(48px, 6vw, 80px) clamp(16px, 4vw, 48px) clamp(32px, 4vw, 48px);
  position: relative;
  z-index: 1;
  overflow: hidden;
}

.site-footer::before {
  content: '';
  position: absolute;
  top: -100px; right: -100px;
  width: 400px; height: 400px;
  background: radial-gradient(circle, rgba(124,58,237,.15) 0%, transparent 70%);
  pointer-events: none;
}

.footer-inner {
  max-width: 1200px;
  margin: 0 auto;
}

.footer-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 48px;
  flex-wrap: wrap;
  padding-bottom: 40px;
  border-bottom: 1px solid rgba(255,255,255,.1);
}

.footer-brand .logo-text { color: white; }
.footer-brand .logo-sub { color: rgba(255,255,255,.4); }

.footer-tagline {
  margin-top: 14px;
  font-size: 0.82rem;
  color: rgba(255,255,255,.5);
  line-height: 1.8;
  max-width: 240px;
}

.footer-nav-group {
  display: flex;
  gap: 48px;
  flex-wrap: wrap;
}

.footer-nav-col {}

.footer-nav-col h4 {
  font-family: var(--font-dot);
  font-size: 0.72rem;
  letter-spacing: 0.14em;
  color: rgba(255,255,255,.4);
  text-transform: uppercase;
  margin-bottom: 14px;
}

.footer-nav-col a {
  display: block;
  color: rgba(255,255,255,.6);
  text-decoration: none;
  font-size: 0.85rem;
  margin-bottom: 8px;
  transition: color .2s;
}

.footer-nav-col a:hover { color: white; }

.footer-bottom {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
  padding-top: 28px;
  flex-wrap: wrap;
}

.footer-copy {
  font-family: var(--font-dot);
  font-size: 0.7rem;
  letter-spacing: 0.08em;
  color: rgba(255,255,255,.3);
}

.footer-sns {
  display: flex;
  gap: 10px;
}

.sns-btn {
  width: 36px; height: 36px;
  border-radius: 10px;
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.12);
  display: grid;
  place-items: center;
  text-decoration: none;
  font-size: 1.1rem;
  transition: background .2s, transform .2s;
}

.sns-btn:hover { background: rgba(255,255,255,.18); transform: translateY(-2px); }

/* ════════════════════════════════════════
   アニメーション
   ════════════════════════════════════════ */

@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(24px); }
  to   { opacity: 1; transform: translateY(0); }
}

.reveal {
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}

.reveal.visible {
  opacity: 1;
  transform: translateY(0);
}

/* ════════════════════════════════════════
   レスポンシブ
   ════════════════════════════════════════ */

@media (max-width: 900px) {
  .hero-deco { display: none; }
  .hero-stats { gap: 20px; }
}

@media (max-width: 720px) {

  /* ══ スマホ：デスクトップ用fixed配置を無効化 ══ */
  .site-nav {
    /* デスクトップのfixed配置をリセット */
    position: fixed;
    top: 0;
    right: 0;
    height: auto;
    /* 閉じた状態：完全に非表示 */
    display: none;
    pointer-events: none;
  }

  .hamburger { display: flex; }

  /* ══ 開いた状態：body直下のfixedドロワー ══ */
  .site-nav.open {
    /* body直下なのでbackdrop-filterの制約ゼロ */
    display: flex !important;
    pointer-events: auto;
    flex-direction: column;
    list-style: none;
    position: fixed;
    top: 64px;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    margin: 0;
    padding: 24px 16px 60px;
    gap: 10px;
    background: rgba(250,248,255,0.98);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    z-index: 1200;   /* headerのz-index(1000)より確実に上 */
    box-shadow: 0 4px 24px rgba(90,60,120,.15);
    animation: navSlideIn 0.2s ease both;
  }

  @keyframes navSlideIn {
    from { opacity: 0; transform: translateY(-10px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* リスト項目 */
  .site-nav.open > li {
    width: 100%;
    display: block;
  }

  /* リンク */
  .site-nav.open > li > a {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 18px 20px;
    border-radius: 16px;
    font-size: 1.05rem;
    font-weight: 700;
    color: var(--ink);
    background: rgba(124,58,237,.05);
    border: 1.5px solid transparent;
    transition: background .15s, border-color .15s, color .15s;
    text-decoration: none;
  }

  .site-nav.open > li > a:hover,
  .site-nav.open > li > a:active {
    background: var(--accent-light);
    color: var(--accent);
    border-color: rgba(124,58,237,.25);
  }

  /* プレミアムリンク */
  .site-nav.open .nav-premium > a {
    background: linear-gradient(135deg, var(--accent), #c026d3) !important;
    color: white !important;
    box-shadow: 0 2px 12px rgba(124,58,237,.3);
  }

  /* ══ スマホ用レイアウト調整 ══ */
  .section-header { flex-direction: column; align-items: flex-start; }
  .cards-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
  .footer-top { flex-direction: column; gap: 32px; }
  .footer-nav-group { gap: 32px; }
}

@media (max-width: 480px) {
  .cards-grid { grid-template-columns: 1fr 1fr; }
  .genre-tabs { gap: 6px; }
  .genre-tab { padding: 8px 14px; font-size: 0.8rem; }
}

/* ────────────────
   TABフィルター JS用
   ──────────────── */
.genre-section { display: block; }
.genre-section.hidden { display: none; }
</style>
</head>

<body>

<!-- ═══════════════════ HEADER ═══════════════════ -->
<header class="site-header">
  <div class="header-inner">

    <a href="#" class="site-logo">
      <div class="logo-mark">⚗</div>
      <span>
        <span class="logo-text">SHINDAN LAB</span>
        <span class="logo-sub">診断の実験室</span>
      </span>
    </a>

    <!-- マイページアイコン -->
    <a href="./mypage.html" class="mypage-icon-btn" id="mypageBtn" aria-label="マイページ" title="マイページ">
      <div class="mypage-avatar-ring" id="mypageAvatarRing">
        <span id="mypageAvatarEmoji">👤</span>
      </div>
      <span class="mypage-label" id="mypageLabel">マイページ</span>
      <span class="mypage-login-dot" id="mypageLoginDot"></span>
    </a>

    <button class="hamburger" id="hamburger" aria-label="メニューを開く">
      <span></span><span></span><span></span>
    </button>

  </div>
</header>

<!-- ═══ スマホ用ドロワーメニュー（headerの外に置くことでbackdrop-filterの制約を回避）═══ -->
<ul class="site-nav" id="siteNav" role="list" aria-label="サイトナビゲーション">
  <li><a href="#about"><span class="nav-icon">📖</span>サイト紹介</a></li>
  <li><a href="#column"><span class="nav-icon">✏️</span>コラム</a></li>
  <li class="nav-premium"><a href="#premium"><span class="nav-icon">✨</span>プレミアム診断</a></li>
  <li><a href="#sns"><span class="nav-icon">🔗</span>関連SNS</a></li>
</ul>

<!-- ═══════════════════ HERO ═══════════════════ -->
<section class="hero">
  <div class="hero-orb hero-orb-1"></div>
  <div class="hero-orb hero-orb-2"></div>
  <div class="hero-orb hero-orb-3"></div>

  <div class="hero-inner">
    <span class="hero-eyebrow">SHINDAN LAB — 診断の実験室</span>

    <h1 class="hero-heading">
      あなたを深掘りする、<br>
      <span class="line-em">遊び心ある診断が集まる場所</span>
    </h1>

    <p class="hero-desc">
      恋愛・友達・仕事・その他——<br>
      自分でも気づいていなかった側面を、<br>
      ちょっとした診断から発見しよう。
    </p>

    <div class="hero-actions">
      <a href="#genres" class="btn-primary">🔬 診断を探す</a>
      <a href="#about" class="btn-ghost">📖 このサイトについて</a>
    </div>

    <div class="hero-stats">
      <div class="stat-item">
        <span class="stat-num">3</span>
        <span class="stat-label">公開中の診断</span>
      </div>
      <div class="stat-item">
        <span class="stat-num">40+</span>
        <span class="stat-label">実装予定</span>
      </div>
      <div class="stat-item">
        <span class="stat-num">4</span>
        <span class="stat-label">ジャンル</span>
      </div>
    </div>
  </div>

  <!-- デコカード -->
  <div class="hero-deco" aria-hidden="true">
    <div class="deco-chip"><span class="emoji">💕</span><span class="label">恋愛関係</span></div>
    <div class="deco-chip"><span class="emoji">👫</span><span class="label">友達関係</span></div>
    <div class="deco-chip"><span class="emoji">💼</span><span class="label">仕事関係</span></div>
    <div class="deco-chip"><span class="emoji">🌈</span><span class="label">その他</span></div>
  </div>
</section>

<!-- ═══════════════════ 新着 ═══════════════════ -->
<section class="section-new reveal">
  <div class="section-inner">
    <div class="section-header">
      <div class="section-title-group">
        <p class="section-eyebrow">LATEST</p>
        <h2 class="section-title">🆕 最新の診断</h2>
      </div>
      <a href="#genres" class="see-all">すべて見る →</a>
    </div>

    <div class="new-scroll-tray" id="newScrollTray">
      <!-- 動的に最新診断がここに表示されます -->
    </div>
  </div>
</section>

<!-- ═══════════════════ ジャンル別診断 ═══════════════════ -->
<section class="section-genres reveal" id="genres">
  <div class="section-inner">
    <div class="section-header">
      <div class="section-title-group">
        <p class="section-eyebrow">GENRES</p>
        <h2 class="section-title">🗂 ジャンルで探す</h2>
      </div>
    </div>

    <!-- タブ -->
    <div class="genre-tabs" id="genreTabs" role="tablist">
      <button class="genre-tab active" data-genre="all" role="tab" aria-selected="true">🔬 すべて</button>
      <button class="genre-tab" data-genre="love" role="tab">💕 恋愛関係</button>
      <button class="genre-tab" data-genre="friend" role="tab">👫 友達関係</button>
      <button class="genre-tab" data-genre="work" role="tab">💼 仕事関係</button>
      <button class="genre-tab" data-genre="other" role="tab">🌈 その他</button>
    </div>

    <!-- ─────────── 恋愛関係 ─────────── -->
    <div class="genre-section" data-genre="love">
      <div class="genre-heading">
        <span class="genre-heading-pill" style="--gc:var(--love);--gc-light:var(--love-light);--gc-dark:var(--love-dark)">💕 恋愛関係</span>
        <span class="genre-count">10 TOOLS （1 公開中）</span>
      </div>
      <div class="cards-grid">

        <!-- ✅ 実装済み -->
        <a href="./関係改善ジェネレータ/index.html" class="diag-card" style="--gc:var(--love);--gc-light:var(--love-light);--gc-dark:var(--love-dark)">
          <div class="card-icon">💌</div>
          <span class="card-genre-badge" style="background:var(--love-light);color:var(--love-dark);">💕 恋愛関係</span>
          <h3 class="card-title">ふたりのモヤモヤ整理室</h3>
          <p class="card-desc">言えずにいる気持ちを可視化し、関係改善のヒントを診断から発見。</p>
          <div class="card-meta">
            <span class="card-questions">📝 複数テーマ</span>
            <span class="card-arrow">→</span>
          </div>
        </a>

        <!-- 以下 実装予定 ×9 -->
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">💘</div>
          <h3 class="card-title">愛着スタイル診断</h3>
          <p class="card-desc">あなたの愛着パターンを4タイプで分類します。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">💬</div>
          <h3 class="card-title">恋愛コミュニケーション診断</h3>
          <p class="card-desc">すれ違いのパターンと改善ヒントを可視化。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🌡</div>
          <h3 class="card-title">恋愛温度チェック</h3>
          <p class="card-desc">今の関係の熱量を客観的に測ってみよう。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🎯</div>
          <h3 class="card-title">理想のパートナー診断</h3>
          <p class="card-desc">あなたが本当に求めているタイプは？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">💔</div>
          <h3 class="card-title">別れの傾向診断</h3>
          <p class="card-desc">恋愛が終わるとき、あなたはどう動く？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🔒</div>
          <h3 class="card-title">嫉妬タイプ診断</h3>
          <p class="card-desc">あなたの嫉妬のかたち・扱い方を知る。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🌙</div>
          <h3 class="card-title">深夜の本音診断</h3>
          <p class="card-desc">言葉にできない本音を引き出す20問。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🎭</div>
          <h3 class="card-title">恋愛依存度チェック</h3>
          <p class="card-desc">自立と依存のバランスを見つめ直そう。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--love);--gc-light:var(--love-light)">
          <div class="card-icon">🌸</div>
          <h3 class="card-title">告白スタイル診断</h3>
          <p class="card-desc">あなたの恋愛アプローチを分析します。</p>
        </div>

      </div>
    </div>

    <!-- ─────────── 友達関係 ─────────── -->
    <div class="genre-section" data-genre="friend">
      <div class="genre-heading">
        <span class="genre-heading-pill" style="--gc:var(--friend);--gc-light:var(--friend-light);--gc-dark:var(--friend-dark)">👫 友達関係</span>
        <span class="genre-count">10 TOOLS （0 公開中）</span>
      </div>
      <div class="cards-grid">

        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🤝</div>
          <h3 class="card-title">友達関係タイプ診断</h3>
          <p class="card-desc">あなたの友達づきあいのスタイルを分類。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🌊</div>
          <h3 class="card-title">友人関係のモヤモヤ整理</h3>
          <p class="card-desc">友人との関係で感じる違和感を言語化。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🪞</div>
          <h3 class="card-title">自己開示度診断</h3>
          <p class="card-desc">あなたはどのくらい自分を見せられる？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🎲</div>
          <h3 class="card-title">グループダイナミクス診断</h3>
          <p class="card-desc">グループ内でのあなたの役割を発見。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">📱</div>
          <h3 class="card-title">SNS友達関係診断</h3>
          <p class="card-desc">オンラインとリアルの友達バランスは？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🔮</div>
          <h3 class="card-title">友情維持スタイル診断</h3>
          <p class="card-desc">長続きする友達関係のつくり方を探る。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">⚡</div>
          <h3 class="card-title">友達との摩擦診断</h3>
          <p class="card-desc">関係がぎこちなくなる原因を分析。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🎈</div>
          <h3 class="card-title">友達作り得意度チェック</h3>
          <p class="card-desc">新しい人間関係に踏み込む力を測定。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🧩</div>
          <h3 class="card-title">相性タイプ診断</h3>
          <p class="card-desc">どんなタイプの人と相性が良い？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--friend);--gc-light:var(--friend-light)">
          <div class="card-icon">🌿</div>
          <h3 class="card-title">境界線スタイル診断</h3>
          <p class="card-desc">人間関係における自他の境界線を知る。</p>
        </div>

      </div>
    </div>

    <!-- ─────────── 仕事関係 ─────────── -->
    <div class="genre-section" data-genre="work">
      <div class="genre-heading">
        <span class="genre-heading-pill" style="--gc:var(--work);--gc-light:var(--work-light);--gc-dark:var(--work-dark)">💼 仕事関係</span>
        <span class="genre-count">10 TOOLS （1 公開中）</span>
      </div>
      <div class="cards-grid">

        <!-- ✅ 実装済み -->
        <a href="./thinktype/index.html" class="diag-card" style="--gc:var(--work);--gc-light:var(--work-light);--gc-dark:var(--work-dark)">
          <div class="card-icon">🧠</div>
          <span class="card-genre-badge" style="background:var(--work-light);color:var(--work-dark);">💼 仕事関係</span>
          <h3 class="card-title">ThinkType｜思考タイプ診断</h3>
          <p class="card-desc">外向×内向・視覚×言語の2軸から、あなた固有の思考スタイルを明らかに。</p>
          <div class="card-meta">
            <span class="card-questions">📝 20問・5段階</span>
            <span class="card-arrow">→</span>
          </div>
        </a>

        <!-- 実装予定 ×9 -->
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">⚙️</div>
          <h3 class="card-title">仕事スタイル診断</h3>
          <p class="card-desc">あなたの仕事への向き合い方を可視化。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🔥</div>
          <h3 class="card-title">バーンアウト傾向診断</h3>
          <p class="card-desc">燃え尽き症候群のリスクを早めに発見。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🎯</div>
          <h3 class="card-title">集中タイプ診断</h3>
          <p class="card-desc">あなたが最も力を発揮できる環境は？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">📊</div>
          <h3 class="card-title">チームポジション診断</h3>
          <p class="card-desc">あなたのチームでの役割を分析します。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🗣</div>
          <h3 class="card-title">フィードバック受け取り方診断</h3>
          <p class="card-desc">批評や評価をどう処理するか知ろう。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">⏰</div>
          <h3 class="card-title">時間管理スタイル診断</h3>
          <p class="card-desc">あなたの時間の使い方のクセを発見。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🔑</div>
          <h3 class="card-title">モチベーション源診断</h3>
          <p class="card-desc">あなたを突き動かす本当の動機は何？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🛡</div>
          <h3 class="card-title">ストレス耐性診断</h3>
          <p class="card-desc">プレッシャーへの対処パターンを分析。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--work);--gc-light:var(--work-light)">
          <div class="card-icon">🌱</div>
          <h3 class="card-title">キャリア欲求診断</h3>
          <p class="card-desc">あなたが仕事に求めているものは何か。</p>
        </div>

      </div>
    </div>

    <!-- ─────────── その他 ─────────── -->
    <div class="genre-section" data-genre="other">
      <div class="genre-heading">
        <span class="genre-heading-pill" style="--gc:var(--other);--gc-light:var(--other-light);--gc-dark:var(--other-dark)">🌈 その他</span>
        <span class="genre-count">10 TOOLS （1 公開中）</span>
      </div>
      <div class="cards-grid">

        <!-- ✅ 実装済み -->
        <a href="./uniquetype/index.html" class="diag-card" style="--gc:var(--other);--gc-light:var(--other-light);--gc-dark:var(--other-dark)">
          <div class="card-icon">😂</div>
          <span class="card-genre-badge" style="background:var(--other-light);color:var(--other-dark);">🌈 その他</span>
          <h3 class="card-title">わらいのツボ診断</h3>
          <p class="card-desc">「笑いのクセ」を4タイプ（ほっこり・ひらめき・スパイス・カオス）に分類。</p>
          <div class="card-meta">
            <span class="card-questions">📝 20問・5段階</span>
            <span class="card-arrow">→</span>
          </div>
        </a>

        <!-- 実装予定 ×9 -->
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🌙</div>
          <h3 class="card-title">睡眠タイプ診断</h3>
          <p class="card-desc">朝型・夜型だけじゃない、睡眠スタイル。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🍽</div>
          <h3 class="card-title">食の個性診断</h3>
          <p class="card-desc">食べ方のクセから性格傾向を分析。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🎨</div>
          <h3 class="card-title">創造性スタイル診断</h3>
          <p class="card-desc">あなたの創造的思考のパターンを発見。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🧘</div>
          <h3 class="card-title">メンタルリセット法診断</h3>
          <p class="card-desc">疲れをとるあなただけの方法を探る。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🚀</div>
          <h3 class="card-title">行動力タイプ診断</h3>
          <p class="card-desc">あなたが動くとき・止まるときのクセ。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">📚</div>
          <h3 class="card-title">学習スタイル診断</h3>
          <p class="card-desc">あなたに合った知識の吸収方法とは？</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🌏</div>
          <h3 class="card-title">価値観マップ診断</h3>
          <p class="card-desc">あなたが人生で大切にしているものを地図に。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">🎭</div>
          <h3 class="card-title">感情表現タイプ診断</h3>
          <p class="card-desc">あなたの感情のかたちと見せ方を知る。</p>
        </div>
        <div class="diag-card coming-soon" style="--gc:var(--other);--gc-light:var(--other-light)">
          <div class="card-icon">⚗️</div>
          <h3 class="card-title">自己分析深掘り診断</h3>
          <p class="card-desc">自分をもっと知りたいときの総合診断。</p>
        </div>

      </div>
    </div>

  </div>
</section>

<!-- ═══════════════════ サイト紹介 ═══════════════════ -->
<section id="about" style="background:var(--bg-warm); padding: clamp(48px,6vw,80px) clamp(16px,4vw,48px); position:relative; z-index:1;">
  <div style="max-width:1200px; margin:0 auto;">
    <div class="section-header reveal">
      <div class="section-title-group">
        <p class="section-eyebrow">ABOUT</p>
        <h2 class="section-title">📖 サイト紹介</h2>
      </div>
    </div>
    <div class="reveal" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:20px; margin-top:8px;">

      <div style="background:white; border-radius:var(--r-lg); padding:28px; box-shadow:var(--shadow-sm); border:1.5px solid rgba(0,0,0,.04);">
        <div style="font-size:2rem; margin-bottom:14px;">⚗️</div>
        <h3 style="font-family:var(--font-display); font-size:1.05rem; margin-bottom:10px;">診断の実験室</h3>
        <p style="font-size:0.82rem; color:var(--ink-mid); line-height:1.8;">SHINDAN LABは、自己理解・他者理解のための診断ツールを集めたポータルサイトです。心理学をベースにしたユニークな切り口で、あなたの新しい側面を発見するお手伝いをします。</p>
      </div>

      <div style="background:white; border-radius:var(--r-lg); padding:28px; box-shadow:var(--shadow-sm); border:1.5px solid rgba(0,0,0,.04);">
        <div style="font-size:2rem; margin-bottom:14px;">🎨</div>
        <h3 style="font-family:var(--font-display); font-size:1.05rem; margin-bottom:10px;">遊びながら、深く知る</h3>
        <p style="font-size:0.82rem; color:var(--ink-mid); line-height:1.8;">真剣になりすぎず、でも本質的な気づきをもたらす——そんな絶妙なバランスの診断ツールを目指しています。友達と比べたり、シェアしたりしながら楽しめます。</p>
      </div>

      <div style="background:white; border-radius:var(--r-lg); padding:28px; box-shadow:var(--shadow-sm); border:1.5px solid rgba(0,0,0,.04);">
        <div style="font-size:2rem; margin-bottom:14px;">🔬</div>
        <h3 style="font-family:var(--font-display); font-size:1.05rem; margin-bottom:10px;">どんどん増えていく</h3>
        <p style="font-size:0.82rem; color:var(--ink-mid); line-height:1.8;">恋愛・友達・仕事・その他の4ジャンル、各10本を目標に制作中。新しい診断は随時追加されます。気になるジャンルをフォローして、お知らせを受け取ってください。</p>
      </div>

    </div>
  </div>
</section>

<!-- ═══════════════════ コラム（プレースホルダー） ═══════════════════ -->
<section id="column" style="padding: clamp(48px,6vw,80px) clamp(16px,4vw,48px); position:relative; z-index:1;">
  <div style="max-width:1200px; margin:0 auto;">
    <div class="section-header reveal">
      <div class="section-title-group">
        <p class="section-eyebrow">COLUMN</p>
        <h2 class="section-title">✏️ コラム</h2>
      </div>
      <a href="#" class="see-all">もっと見る →</a>
    </div>
    <div class="reveal" style="display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:20px;">

      <!-- コラム記事プレースホルダー ×3 -->
      <div style="background:white; border-radius:var(--r-lg); overflow:hidden; box-shadow:var(--shadow-sm); border:1.5px dashed rgba(124,58,237,.15);">
        <div style="height:120px; background:linear-gradient(135deg,var(--accent-light),#fdf4ff); display:flex; align-items:center; justify-content:center; font-size:2.5rem;">✏️</div>
        <div style="padding:20px;">
          <span style="font-family:var(--font-dot); font-size:0.66rem; color:var(--ink-soft); letter-spacing:0.1em;">記事準備中</span>
          <h3 style="font-family:var(--font-display); font-size:0.95rem; margin:8px 0; color:var(--ink-mid);">コラム記事タイトルが入ります</h3>
          <p style="font-size:0.76rem; color:#bbb; line-height:1.7;">コラムの概要テキストが入ります。近日公開予定。</p>
        </div>
      </div>
      <div style="background:white; border-radius:var(--r-lg); overflow:hidden; box-shadow:var(--shadow-sm); border:1.5px dashed rgba(124,58,237,.15);">
        <div style="height:120px; background:linear-gradient(135deg,#d9f5ec,#fef9d9); display:flex; align-items:center; justify-content:center; font-size:2.5rem;">💡</div>
        <div style="padding:20px;">
          <span style="font-family:var(--font-dot); font-size:0.66rem; color:var(--ink-soft); letter-spacing:0.1em;">記事準備中</span>
          <h3 style="font-family:var(--font-display); font-size:0.95rem; margin:8px 0; color:var(--ink-mid);">コラム記事タイトルが入ります</h3>
          <p style="font-size:0.76rem; color:#bbb; line-height:1.7;">コラムの概要テキストが入ります。近日公開予定。</p>
        </div>
      </div>
      <div style="background:white; border-radius:var(--r-lg); overflow:hidden; box-shadow:var(--shadow-sm); border:1.5px dashed rgba(124,58,237,.15);">
        <div style="height:120px; background:linear-gradient(135deg,#dde9ff,#ffe4ef); display:flex; align-items:center; justify-content:center; font-size:2.5rem;">🔍</div>
        <div style="padding:20px;">
          <span style="font-family:var(--font-dot); font-size:0.66rem; color:var(--ink-soft); letter-spacing:0.1em;">記事準備中</span>
          <h3 style="font-family:var(--font-display); font-size:0.95rem; margin:8px 0; color:var(--ink-mid);">コラム記事タイトルが入ります</h3>
          <p style="font-size:0.76rem; color:#bbb; line-height:1.7;">コラムの概要テキストが入ります。近日公開予定。</p>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- ═══════════════════ プレミアム診断 ═══════════════════ -->
<section id="premium" style="padding: clamp(48px,6vw,80px) clamp(16px,4vw,48px); background: var(--ink); position:relative; z-index:1; overflow:hidden;">
  <div style="position:absolute; top:-80px; right:-80px; width:400px; height:400px; background:radial-gradient(circle,rgba(124,58,237,.25) 0%,transparent 70%); pointer-events:none;"></div>
  <div style="position:absolute; bottom:-60px; left:-60px; width:300px; height:300px; background:radial-gradient(circle,rgba(192,38,211,.2) 0%,transparent 70%); pointer-events:none;"></div>

  <div style="max-width:1200px; margin:0 auto; position:relative; z-index:1;">
    <div class="reveal" style="text-align:center; max-width:560px; margin:0 auto 40px;">
      <span style="display:inline-block; padding:5px 16px; background:rgba(124,58,237,.3); border:1.5px solid rgba(124,58,237,.5); border-radius:var(--r-full); font-family:var(--font-dot); font-size:0.7rem; color:rgba(255,255,255,.8); letter-spacing:0.14em; margin-bottom:20px;">✨ PREMIUM</span>
      <h2 style="font-family:var(--font-display); font-size:clamp(1.6rem,4vw,2.6rem); color:white; margin-bottom:16px;">より深く、あなたを知る<br>プレミアム診断</h2>
      <p style="font-size:0.88rem; color:rgba(255,255,255,.6); line-height:1.9;">通常診断より詳細な分析・レポート・アドバイスが得られるプレミアムコンテンツを準備中です。</p>
    </div>

    <div class="reveal" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:16px;">

      <div style="background:rgba(255,255,255,.06); border:1.5px dashed rgba(255,255,255,.18); border-radius:var(--r-lg); padding:24px; text-align:center;">
        <div style="font-size:2rem; margin-bottom:12px;">💎</div>
        <h3 style="font-family:var(--font-display); color:white; font-size:0.95rem; margin-bottom:8px;">プレミアム診断 ①</h3>
        <p style="font-size:0.76rem; color:rgba(255,255,255,.4);">準備中</p>
      </div>
      <div style="background:rgba(255,255,255,.06); border:1.5px dashed rgba(255,255,255,.18); border-radius:var(--r-lg); padding:24px; text-align:center;">
        <div style="font-size:2rem; margin-bottom:12px;">🌟</div>
        <h3 style="font-family:var(--font-display); color:white; font-size:0.95rem; margin-bottom:8px;">プレミアム診断 ②</h3>
        <p style="font-size:0.76rem; color:rgba(255,255,255,.4);">準備中</p>
      </div>
      <div style="background:rgba(255,255,255,.06); border:1.5px dashed rgba(255,255,255,.18); border-radius:var(--r-lg); padding:24px; text-align:center;">
        <div style="font-size:2rem; margin-bottom:12px;">🔮</div>
        <h3 style="font-family:var(--font-display); color:white; font-size:0.95rem; margin-bottom:8px;">プレミアム診断 ③</h3>
        <p style="font-size:0.76rem; color:rgba(255,255,255,.4);">準備中</p>
      </div>

    </div>
  </div>
</section>

<!-- ═══════════════════ SNS ═══════════════════ -->
<section id="sns" style="padding: clamp(48px,6vw,80px) clamp(16px,4vw,48px); background:var(--bg-warm); position:relative; z-index:1;">
  <div style="max-width:1200px; margin:0 auto; text-align:center;">
    <div class="reveal">
      <p class="section-eyebrow" style="justify-content:center; margin-bottom:12px;">SNS</p>
      <h2 style="font-family:var(--font-display); font-size:clamp(1.4rem,3vw,2rem); margin-bottom:16px;">🔗 関連SNS・フォローしよう</h2>
      <p style="font-size:0.85rem; color:var(--ink-mid); line-height:1.8; margin-bottom:36px;">新しい診断の更新情報・コラム・診断結果のシェアはこちらから。</p>
    </div>

    <div class="reveal" style="display:flex; justify-content:center; gap:16px; flex-wrap:wrap;">

      <a href="#" style="display:flex; align-items:center; gap:10px; padding:14px 24px; background:white; border:1.5px solid rgba(0,0,0,.06); border-radius:var(--r-full); text-decoration:none; color:var(--ink); font-weight:700; font-size:0.88rem; box-shadow:var(--shadow-sm); transition:transform .2s,box-shadow .2s;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 24px rgba(0,0,0,.12)'" onmouseout="this.style.transform='';this.style.boxShadow='var(--shadow-sm)'">
        <span style="font-size:1.2rem;">𝕏</span> X（Twitter）
      </a>
      <a href="#" style="display:flex; align-items:center; gap:10px; padding:14px 24px; background:linear-gradient(135deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888); color:white; border-radius:var(--r-full); text-decoration:none; font-weight:700; font-size:0.88rem; box-shadow:0 4px 14px rgba(220,39,67,.3); transition:transform .2s,box-shadow .2s;" onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform=''">
        <span style="font-size:1.2rem;">📸</span> Instagram
      </a>
      <a href="#" style="display:flex; align-items:center; gap:10px; padding:14px 24px; background:#06C755; color:white; border-radius:var(--r-full); text-decoration:none; font-weight:700; font-size:0.88rem; box-shadow:0 4px 14px rgba(6,199,85,.3); transition:transform .2s;" onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform=''">
        <span style="font-size:1.2rem;">💬</span> LINE
      </a>

    </div>
  </div>
</section>

<!-- ═══════════════════ FOOTER ═══════════════════ -->
<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-top">

      <div class="footer-brand">
        <a href="#" class="site-logo" style="text-decoration:none;">
          <div class="logo-mark">⚗</div>
          <span>
            <span class="logo-text">SHINDAN LAB</span>
            <span class="logo-sub" style="color:rgba(255,255,255,.35);">診断の実験室</span>
          </span>
        </a>
        <p class="footer-tagline">遊び心と自己理解が<br>出会う場所。</p>
      </div>

      <div class="footer-nav-group">
        <div class="footer-nav-col">
          <h4>GENRE</h4>
          <a href="#genres">💕 恋愛関係</a>
          <a href="#genres">👫 友達関係</a>
          <a href="#genres">💼 仕事関係</a>
          <a href="#genres">🌈 その他</a>
        </div>
        <div class="footer-nav-col">
          <h4>PAGES</h4>
          <a href="#about">📖 サイト紹介</a>
          <a href="#column">✏️ コラム</a>
          <a href="#premium">✨ プレミアム診断</a>
          <a href="#sns">🔗 関連SNS</a>
        </div>
        <div class="footer-nav-col">
          <h4>DIAGNOSES</h4>
          <a href="./kankei/index.html">ふたりのモヤモヤ整理室</a>
          <a href="./thinktype/index.html">ThinkType 思考タイプ診断</a>
          <a href="./uniquetype/index.html">わらいのツボ診断</a>
        </div>
      </div>

    </div>

    <div class="footer-bottom">
      <p class="footer-copy">© 2025 SHINDAN LAB. All rights reserved.</p>
      <div class="footer-sns">
        <a href="#" class="sns-btn" aria-label="X（Twitter）">𝕏</a>
        <a href="#" class="sns-btn" aria-label="Instagram">📸</a>
        <a href="#" class="sns-btn" aria-label="LINE">💬</a>
      </div>
    </div>

  </div>
</footer>

<!-- ═══════════════════ JAVASCRIPT ═══════════════════ -->
<script>
/* ── ハンバーガーメニュー ── */
const hamburger = document.getElementById('hamburger');
const nav = document.getElementById('siteNav');

/* ── メニュー開閉ユーティリティ ── */
function closeNav() {
  nav.classList.remove('open');
  hamburger.setAttribute('aria-expanded', 'false');
  hamburger.querySelectorAll('span').forEach(s => s.style.cssText = '');
  document.body.style.overflow = '';
}
function openNav() {
  nav.classList.add('open');
  hamburger.setAttribute('aria-expanded', 'true');
  const spans = hamburger.querySelectorAll('span');
  spans[0].style.cssText = 'transform:translateY(7px) rotate(45deg)';
  spans[1].style.cssText = 'opacity:0';
  spans[2].style.cssText = 'transform:translateY(-7px) rotate(-45deg)';
  document.body.style.overflow = 'hidden';
}

hamburger.addEventListener('click', () => {
  if (nav.classList.contains('open')) { closeNav(); } else { openNav(); }
});

// リンククリックで閉じる
nav.querySelectorAll('a').forEach(a => {
  a.addEventListener('click', () => closeNav());
});

// メニュー外タップで閉じる（スマホ対応）
document.addEventListener('touchstart', (e) => {
  if (nav.classList.contains('open') &&
      !nav.contains(e.target) &&
      !hamburger.contains(e.target)) {
    closeNav();
  }
}, { passive: true });

/* ── ジャンルタブ ── */
const tabs = document.querySelectorAll('.genre-tab');
const sections = document.querySelectorAll('.genre-section');

tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    // アクティブ解除
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    const genre = tab.dataset.genre;

    sections.forEach(sec => {
      if (genre === 'all' || sec.dataset.genre === genre) {
        sec.classList.remove('hidden');
      } else {
        sec.classList.add('hidden');
      }
    });

    // スクロール
    document.getElementById('genres').scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
});

/* ── スクロールReveal ── */
const revealEls = document.querySelectorAll('.reveal');
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

revealEls.forEach(el => observer.observe(el));

/* ── 診断ツール動的管理システム ── */
class DiagnosisManager {
  constructor() {
    // 診断ツールの設定データ
    this.diagnoses = [
      {
        id: 'relationship',
        title: 'ふたりのモヤモヤ整理室',
        desc: '言えずにいる気持ちを可視化。関係改善のきっかけを診断から見つけよう。',
        emoji: '💌',
        genre: 'love',
        genreLabel: '💕 恋愛関係',
        path: './関係改善ジェネレータ/index.html',
        gradient: 'linear-gradient(135deg, #ffe4ef 0%, #fde8e8 100%)',
        addedDate: new Date('2025-01-15')
      },
      {
        id: 'thinktype',
        title: 'ThinkType｜思考タイプ診断',
        desc: '外向×内向・視覚×言語の2軸で、あなた固有の思考スタイルを明らかに。',
        emoji: '🧠',
        genre: 'work',
        genreLabel: '💼 仕事関係',
        path: './thinktype/index.html',
        gradient: 'linear-gradient(135deg, #dde9ff 0%, #ede9fe 100%)',
        addedDate: new Date('2025-01-10')
      },
      {
        id: 'uniquetype',
        title: 'わらいのツボ診断',
        desc: 'あなたの「笑いのクセ」を4タイプに分類。ほっこり・ひらめき・スパイス・カオス。',
        emoji: '😂',
        genre: 'other',
        genreLabel: '🌈 その他',
        path: './uniquetype/index.html',
        gradient: 'linear-gradient(135deg, #fef0d5 0%, #ffeef4 100%)',
        addedDate: new Date('2025-01-05')
      }
    ];
    
    this.genreColors = {
      love: { light: 'var(--love-light)', dark: 'var(--love-dark)' },
      friend: { light: 'var(--friend-light)', dark: 'var(--friend-dark)' },
      work: { light: 'var(--work-light)', dark: 'var(--work-dark)' },
      other: { light: 'var(--other-light)', dark: 'var(--other-dark)' }
    };
  }

  // 新しい診断を追加するメソッド
  addDiagnosis(diagnosis) {
    diagnosis.addedDate = new Date();
    this.diagnoses.push(diagnosis);
    this.updateLatestDiagnoses();
    this.updateGenreSections();
    this.updateFooter();
    this.updateStats();
  }

  // 最新の診断3つを取得
  getLatestDiagnoses(count = 3) {
    return [...this.diagnoses]
      .sort((a, b) => b.addedDate - a.addedDate)
      .slice(0, count);
  }

  // 新着診断セクションを更新
  updateLatestDiagnoses() {
    const container = document.getElementById('newScrollTray');
    if (!container) return;

    const latest = this.getLatestDiagnoses(3);
    
    container.innerHTML = latest.map((diagnosis, index) => `
      <a href="${diagnosis.path}" class="new-card">
        <div class="new-card-thumb" style="background: ${diagnosis.gradient};">
          ${diagnosis.emoji}
        </div>
        ${index === 0 ? '<span class="new-tag">NEW</span>' : ''}
        <div class="new-card-body">
          <span class="new-card-badge" style="background:${this.genreColors[diagnosis.genre].light};color:${this.genreColors[diagnosis.genre].dark};">
            ${diagnosis.genreLabel}
          </span>
          <h3 class="new-card-title">${diagnosis.title}</h3>
          <p class="new-card-desc">${diagnosis.desc}</p>
        </div>
      </a>
    `).join('');
  }

  // ジャンルセクションを更新
  updateGenreSections() {
    const genres = ['love', 'friend', 'work', 'other'];
    
    genres.forEach(genre => {
      const section = document.querySelector(`[data-genre="${genre}"] .cards-grid`);
      if (!section) return;

      const genreDiagnoses = this.diagnoses.filter(d => d.genre === genre);
      const implemented = genreDiagnoses.filter(d => d.path);
      
      // 実装済み診断を更新
      const implementedCards = implemented.map(diagnosis => `
        <a href="${diagnosis.path}" class="diag-card" style="--gc:var(--${genre});--gc-light:var(--${genre}-light);--gc-dark:var(--${genre}-dark)">
          <div class="card-icon">${diagnosis.emoji}</div>
          <span class="card-genre-badge" style="background:var(--${genre}-light);color:var(--${genre}-dark);">
            ${diagnosis.genreLabel}
          </span>
          <h3 class="card-title">${diagnosis.title}</h3>
          <p class="card-desc">${diagnosis.desc}</p>
          <div class="card-meta">
            <span class="card-questions">📝 診断実装済み</span>
            <span class="card-arrow">→</span>
          </div>
        </a>
      `).join('');

      // 既存の実装済みカードを置き換え
      const existingCards = section.querySelectorAll('.diag-card:not(.coming-soon)');
      existingCards.forEach(card => card.remove());
      
      // 新しい実装済みカードを先頭に追加
      if (implementedCards) {
        section.insertAdjacentHTML('afterbegin', implementedCards);
      }

      // カウンターを更新
      const counter = document.querySelector(`[data-genre="${genre}"] .genre-count`);
      if (counter) {
        const total = 10; // 設定上の最大数
        const active = implemented.length;
        counter.textContent = `${total} TOOLS （${active} 公開中）`;
      }
    });
  }

  // フッターの診断リンクを更新
  updateFooter() {
    const footerDiagnoses = document.querySelector('.footer-nav-col h4');
    if (!footerDiagnoses || footerDiagnoses.textContent !== 'DIAGNOSES') return;

    const footerCol = footerDiagnoses.parentElement;
    const latest = this.getLatestDiagnoses(3);
    
    const diagnosisLinks = latest.map(diagnosis => 
      `<a href="${diagnosis.path}">${diagnosis.title}</a>`
    ).join('');

    // 既存の診断リンクを更新
    const existingLinks = footerCol.querySelectorAll('a');
    existingLinks.forEach(link => link.remove());
    footerCol.insertAdjacentHTML('beforeend', diagnosisLinks);
  }

  // 統計情報を更新
  updateStats() {
    const implementedCount = this.diagnoses.filter(d => d.path).length;
    const statNum = document.querySelector('.stat-num');
    if (statNum) {
      statNum.textContent = implementedCount;
    }
  }

  // 初期化
  init() {
    this.updateLatestDiagnoses();
    this.updateGenreSections();
    this.updateFooter();
    this.updateStats();
  }
}

// 診断マネージャーを初期化
const diagnosisManager = new DiagnosisManager();
diagnosisManager.init();

/* ── アクティブナビハイライト（スクロール連動） ── */
const navLinks = nav.querySelectorAll('a[href^="#"]');
const sectionTargets = [];

navLinks.forEach(link => {
  const id = link.getAttribute('href').slice(1);
  const el = document.getElementById(id);
  if (el) sectionTargets.push({ link, el });
});

window.addEventListener('scroll', () => {
  const scrollY = window.scrollY + 80;
  sectionTargets.forEach(({ link, el }) => {
    const top = el.offsetTop;
    const bottom = top + el.offsetHeight;
    if (scrollY >= top && scrollY < bottom) {
      navLinks.forEach(l => l.parentElement.classList.remove('active-nav'));
      link.parentElement.classList.add('active-nav');
    }
  });
}, { passive: true });

/* ════════════════════════════════════
   🔥 Firebase ログイン状態反映（ヘッダー）
   ════════════════════════════════════ */
// Firebase CDN（mypage.htmlと同じ設定）
const _fbScript1 = document.createElement('script');
_fbScript1.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js';
document.head.appendChild(_fbScript1);

_fbScript1.onload = () => {
  const _fbScript2 = document.createElement('script');
  _fbScript2.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js';
  document.head.appendChild(_fbScript2);

  const _fbScript3 = document.createElement('script');
  _fbScript3.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js';
  document.head.appendChild(_fbScript3);

  _fbScript2.onload = () => {
    _fbScript3.onload = () => {
      // Firebase設定（firebase-common.jsと同一値）
      const firebaseConfig = {
        apiKey:            "AIzaSyBLuQpm7NASl4kD4FTKPOmHNfuaWT_ydEI",
        authDomain:        "shindanlab-eedc0.firebaseapp.com",
        projectId:         "shindanlab-eedc0",
        storageBucket:     "shindanlab-eedc0.firebasestorage.app",
        messagingSenderId: "946383078896",
        appId:             "1:946383078896:web:09e48c3f75f2d7e8d8c935"
      };

      // 既に初期化済みなら再利用
      if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
      const _auth = firebase.auth();
      const _db   = firebase.firestore();

      const dot       = document.getElementById('mypageLoginDot');
      const avatarEl  = document.getElementById('mypageAvatarEmoji');
      const labelEl   = document.getElementById('mypageLabel');

      _auth.onAuthStateChanged(async (user) => {
        if (user) {
          dot.classList.add('visible');
          try {
            const doc = await _db.collection('users').doc(user.uid).get();
            const data = doc.exists ? doc.data() : {};
            avatarEl.textContent = data.avatar || '🧪';
            const name = (data.username || user.displayName || 'あなた');
            labelEl.textContent = name.length > 6 ? name.slice(0, 6) + '…' : name;
          } catch(e) {
            avatarEl.textContent = '🧪';
          }
        } else {
          dot.classList.remove('visible');
          avatarEl.textContent = '👤';
          labelEl.textContent  = 'マイページ';
        }
      });
    };
  };
};
</script>
</body>
</html>
